{% extends "index.html" %}
{% block titulo %}
RECEBIMENTOS
{% endblock %}
{% block nav-bar %}

    <!-------------------------------barra de pesquisa-------------------------------->
<div class="row">
    <div class="col-lg-12">
        <div class="card crud-bar">
            <div class="row justify-content-center align-items-center form-group">
                <form method="post" class="col-xs-12 col-sm-12 col-md-12 col-xl-12 row justify-content-start" id="form1">
                {% csrf_token %}

                    <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6 container-input-create-secundary">
                        <div class="form-group">
                            <div class="form-control-wrap">
                                <div class="form-icon icon-calendar form-icon-right">
                                    <em class="icon ni ni-calendar-alt"></em>
                                </div>
                                {{ form.data_inicio }}
                                <label class="form-label-outlined label-search" for="id_data_inicio">Data Inicio</label>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6 container-input-create-secundary">
                        <div class="form-group">
                            <div class="form-control-wrap">
                                <div class="form-icon icon-calendar form-icon-right">
                                    <em class="icon ni ni-calendar-alt"></em>
                                </div>
                                {{ form.data_fim }}
                                <label class="form-label-outlined label-search" for="id_data_fim">Data Fim</label>
                            </div>
                        </div>
                    </div>

                    {% if request.session.perfil_max != 9 %}
                    <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6 container-input-create-secundary">
                        <div class="form-group">
                            <div class="form-control-wrap">
                                {% if form.gerente %}
                                    {{ form.gerente }}
                                <label class="form-label-outlined label-search" for="id_gerente">Gerente</label>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6 container-input-create-secundary">
                        <div class="form-group">
                            <div class="form-control-wrap">
                                {% if form.pdv %}
                                    {{ form.pdv }}
                                <label class="form-label-outlined label-search" for="id_pdv">PDV</label>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% if request.session.perfil_max != 9 %}
                    <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6 container-input-create-secundary">
                        <div class="form-group">
                            <div class="form-control-wrap">
                                {% if form.leiturista %}
                                    {{ form.leiturista }}
                                <label class="form-label-outlined label-search" for="id_leiturista">Leiturista</label>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    <div class="col-12 col-sm-6 col-md-6 col-lg-6 col-xl-4 container-input-search text-right form-group">
                        <button class="col-3 col-sm-6 col-md-4 col-lg-3 col-xl-3 justify-content-center btn btn-success btn-search form-control-lg">
                            <em class="icon ni ni-search"></em>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    </div>
    <!------------------------------------------------------------------------------->

    <!-------------------------------Cards de Status-------------------------------->
    <div class="row my-row">

    <div class="col-sm-6 col-md-6 col-lg-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-inbox-in icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Recebido</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card color-card-online">{{ recebidos|floatformat:2 }}</h6>
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-md-6 col-lg-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-trend-up icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Pago</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card color-card-offline">{{ pago|floatformat:2 }}</h6>
            </div>
        </div>
    </div>


    <div class="col-sm-6 col-md-6 col-lg-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-trend-up icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Líquido</h6>
            </div>
            <div class="row">
                {%if liquido < 0 %}
                    <h6 class="col-12 text-right subtitle-card color-card-offline">{{ liquido|floatformat:2 }}</h6>
                {% else %}
                    <h6 class="col-12 text-right subtitle-card color-card-online">{{ liquido|floatformat:2 }}</h6>
                {%endif%}
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-md-6 col-lg-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-trend-up icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">POS</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card color-card-pos">{{ pos }}/{{pos_total}}</h6>
            </div>
        </div>
    </div>
    <!--
    <div class="col-sm-6 col-md-6 col-lg-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-sign-mxn icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Saldo</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card {% if saldo < 0 %} color-card-offline {% else %} color-card-online {% endif %}">{{ saldo|floatformat:2 }}</h6>
            </div>
        </div>
    </div>
    -->
    </div>

    <!-------------------------------tabela de generica de cambistas-------------------------------->
    <div class="row my-row">
    <div class="col-12">
        <div class="card table-responsive-xl overflow-auto">
            <table id='tabelaRecebimentos' class="table position-relative table-content">
                <thead class="thead-dark text-center thead-content">
                    <tr>
                    <th scope="col">Data</th>
                    <th scope="col">Leiturista</th>
                    <th scope="col">PDV</th>
                    <th scope="col">Status</th>
                    <!--<th scope="col">Saldo Anterior</th>-->
                        <th scope="col">Operação</th>
                    <th scope="col">Valor da Operação</th>
                    <th scope="col">Saldo Posterior</th>
                    <!--<th scope="col">Saldo Atual</th>-->
                    </tr>
                </thead>
                <tbody class="text-center tbody-content">
                <!--{% if not pos %}<tr><td colspan="5">Nenhum resultado encontrado</td> </tr>{% endif %}-->
                {% for transacao,pdv,saldo_anterior,saldo_posterior in dados %}
                    <tr class="borda-table-linha">
                        <td class="linhas-normais">{{ transacao.data_transacao|date:"SHORT_DATETIME_FORMAT" }}</td>
                        <td class="linhas-normais">{% if transacao.tipo == "T" %}{{ transacao.carteira_para.proprietario }}
                            {% else %}{{ transacao.carteira_de.proprietario }}{% endif %}
                        </td>
                        <td class="linhas-normais">{{ pdv }}</td>
                        <td class="linhas-normais">{% if pdv.ativo %} ATIVO {% else %} INATIVO {% endif %}
                        <!--{%if transacao.tipo == "A" %}<td class="linhas-normais">{{ saldo_anterior|floatformat:2 }}</td>{%else%}<td class="linhas-normais">{{ saldo_anterior|floatformat:2 }}</td>{%endif%}-->
                        <td class="linhas-normais">
                            {% if transacao.tipo == "A" %}
                            Pago
                            {% else %}
                            Recebido
                            {% endif %}
                        </td>
                        {%if transacao.tipo == "A" %}<td class="destaque-transacao">{{ transacao.valor|floatformat:2 }}</td>{%else%}<td class="destaque-transacao">{{ transacao.valor|floatformat:2 }}</td>{%endif%}
                        {%if transacao.tipo == "A" %}<td class="destaque-transacao">{{ saldo_posterior|floatformat:2 }}</td>{%else%}<td class="destaque-transacao">{{ saldo_posterior|floatformat:2 }}</td>{%endif%}
                    </tr>
                    {% endfor %}
                </tbody>
                </table>

        </div>
    </div>
</div>
  
<script>
    $(document).ready( function () {
        $('#tabelaRecebimentos').DataTable({
            "language": {
                "url":"https://cdn.datatables.net/plug-ins/1.10.24/i18n/Portuguese-Brasil.json",
            },
            "dom": '',  
            paging: false,
        });
    } );
</script>        
    <!-- content @e -->
{% endblock %}