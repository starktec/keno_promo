
{% extends "nav-bar.html" %}
{% block titulo %}
RECOLHE
{% endblock %}
{% block nav-bar %}

<!-------------------------------barra de pesquisa-------------------------------->
{% if request.session.perfil_max < 7 %}
<div class="row">
    <div class="col-lg-12">
        <div class="card crud-bar">
            <div class="row justify-content-center align-items-center form-group">
                <form action="" method="post" class="col-xs-12 col-sm-12 col-md-12 col-xl-12 row justify-content-start">
                    {% csrf_token %}
                    <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6 container-input-create-secundary">
                        <div class="form-group">
                            <div class="form-control-wrap">
                                {{ form.representante }}
                                <label class="form-label-outlined label-search" for="id_representante">Leiturista</label>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-sm-2 col-md-2 col-lg-1 col-xl-1 container-input-search text-right form-group">
                        <button class="col-3 col-sm-12 col-md-12 col-lg-12 col-xl-12 justify-content-center btn btn-success btn-search form-control-lg">
                            <em class="icon ni ni-search"></em>
                        </button>
                    </div>

                </form>
                
            </div>
            <div>
                <a href="/solicitacoes_recolhe/" class="btn btn-lg text-right btn-danger btn-create">
                    <em class="icon ni ni-plus"></em>
                    <p>Solicitações de Recolhe</p>
                </a>
            </div>
        </div>          
    </div>
</div>
{% endif %}
<!---------------------------------------------------------------------------------->
<div class="row my-row">
    <div class="col-md-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-sign-mxn icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Pagar:</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card color-card-offline">{{ aporte_T|floatformat:2 }}</h6>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-sign-mxn icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Receber:</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card color-card-online">{{ recebimento_T|floatformat:2 }}</h6>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-sign-mxn icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Saldo:</h6>
            </div>
            <div class="row">
            {%if saldo_T > 0%}
                <h6 class="col-12 text-right subtitle-card color-card-online">{{ saldo_T|floatformat:2 }}</h6>
            {%else%}
                <h6 class="col-12 text-right subtitle-card color-card-offline">{{ saldo_T|floatformat:2 }}</h6>
            {%endif%}
            </div>
        </div>
    </div>
</div>
<!-------------Dados do leiturista selecionado-------->
{% if saldo_L != None %}
<div class="row my-row">
    <div class="col-md-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-sign-mxn icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Pagou:</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card color-card-offline">{{ aporte_L|floatformat:2 }}</h6>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-sign-mxn icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Recebeu:</h6>
            </div>
            <div class="row">
                <h6 class="col-12 text-right subtitle-card color-card-online">{{ recebimento_L|floatformat:2 }}</h6>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card cards-status">
            <div class="row text-center">
                <em class="icon ni ni-sign-mxn icon-card color-card-pos"></em>
                <h6 class="title-card color-card-pos">Cx:</h6>
            </div>
            <div class="row">
            {%if saldo_T > 0%}
                <h6 class="col-12 text-right subtitle-card color-card-online">{{ saldo_L|floatformat:2 }}</h6>
            {%else%}
                <h6 class="col-12 text-right subtitle-card color-card-offline">{{ saldo_L|floatformat:2 }}</h6>
            {%endif%}
            </div>
        </div>
    </div>
</div>
{% endif %}
<!-------------------------------tabela de generica de cambistas-------------------------------->
<div class="row my-row">
    <div class="col-12">
        <div class="card table-responsive-xl overflow-auto">
            <table id='tabelaRecolher' class="table position-relative table-content">
                <thead class="thead-dark text-center thead-content">
                    <tr>
                        <th scope="col" colspan="10"><h6 style="color:white" >PDVS ATIVOS</h6></th>
                    </tr>
                    <tr>
                    <th scope="col">PDV</th>
                    <th scope="col">Vendedor</th>
                    <th scope="col">Ult Rec - Data</th>
                    <th scope="col">Ult Rec - R$</th>
                    <th scope="col">Leiturista</th>
                    <th scope="col">Memoria</th>
                    <th scope="col">Doações</th>
                    <th scope="col">Pre.Pagos</th>
                    <th scope="col">Comissão</th>
                    <th scope="col">A Recolher</th>
                    </tr>
                </thead>
                <tbody class="text-center tbody-content">
                {% if not estabelecimentos %}
                <tr><td colspan="11">Nenhum resultado encontrado</td> </tr>
                {% endif %}
{% for e,memoria, data_ultimo_recolhe,valor_ultimo_recolhe,recolher, recolhedor, doacoes, premios_apagar, premios_pagos, comissao in estabelecimentos %}
                    {% if e.ativo %}
                    <tr>
                        <th scope="row">{{ e.id }}</th>
                        <td>{{ e.vendedor|title }}</td>
                        <td>{{ data_ultimo_recolhe|date:"SHORT_DATETIME_FORMAT" }}</td>
                        <td>
                            {% if valor_ultimo_recolhe < 0 %}
                            <p class="negativo">
                            {% else %}
                            <p class="positivo">
                            {% endif %}
                            {{ valor_ultimo_recolhe|floatformat:2 }}</p></td>
                        <td>{{ recolhedor }}</td>
                        <td>
                            {% if memoria < 0 %}
                            <p class="negativo">{{ memoria|floatformat:2 }}</p>
                            {% else %}
                            <p class="positivo">{{ memoria|floatformat:2 }}</p>
                            {% endif %}
                        </td>
                        <td>{{ doacoes|floatformat:2 }}</td>
                        <td>{{ premios_pagos|floatformat:2 }}</td>
                        <td>{{ comissao|floatformat:2 }}</td>
                        <td class="result">
                            {% if recolher < 0 %}
                            <p class="negativo">{{ recolher|floatformat:2 }}</p>
                            {% else %}
                            <p class="positivo">{{ recolher|floatformat:2 }}</p>
                            {% endif %}
                        </td>
                    </tr>
                    {% endif %}
{% endfor %}

                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="row my-row">
    <div class="col-12">
        <div class="card table-responsive-xl overflow-auto">
            <table id='tabelaRecolherinativo' class="table position-relative table-content">
                <thead class="thead-dark text-center thead-content">
                    <tr>
                        <th scope="col" colspan="10"><h6 style="color:white" >PDVS INATIVOS</h6></th>
                    </tr>
                    <tr>
                    <th scope="col">PDV</th>
                    <th scope="col">Vendedor</th>
                    <th scope="col">Ult Rec - Data</th>
                    <th scope="col">Ult Rec - R$</th>
                    <th scope="col">Leiturista</th>
                    <th scope="col">Memoria</th>
                    <th scope="col">Doações</th>
                    <th scope="col">Pre.Pagos</th>
                    <th scope="col">Comissão</th>
                    <th scope="col">A Recolher</th>
                    </tr>
                </thead>
                <tbody class="text-center tbody-content">
                {% if not estabelecimentos %}
                <tr><td colspan="11">Nenhum resultado encontrado</td> </tr>
                {% endif %}
{% for e,memoria, data_ultimo_recolhe,valor_ultimo_recolhe,recolher, recolhedor, doacoes, premios_apagar, premios_pagos, comissao in estabelecimentos %}
                    {% if  not e.ativo %}
                    <tr>
                        <th scope="row">{{ e.id }}</th>
                        <td>{{ e.vendedor|title }}</td>
                        <td>{{ data_ultimo_recolhe|date:"SHORT_DATETIME_FORMAT" }}</td>
                        <td>
                            {% if valor_ultimo_recolhe < 0 %}
                            <p class="negativo">
                            {% else %}
                            <p class="positivo">
                            {% endif %}
                            {{ valor_ultimo_recolhe|floatformat:2 }}</p></td>
                        <td>{{ recolhedor }}</td>
                        <td>
                            {% if memoria < 0 %}
                            <p class="negativo">{{ memoria|floatformat:2 }}</p>
                            {% else %}
                            <p class="positivo">{{ memoria|floatformat:2 }}</p>
                            {% endif %}
                        </td>
                        <td>{{ doacoes|floatformat:2 }}</td>
                        <td>{{ premios_pagos|floatformat:2 }}</td>
                        <td>{{ comissao|floatformat:2 }}</td>
                        <td class="result">
                            {% if recolher < 0 %}
                            <p class="negativo">{{ recolher|floatformat:2 }}</p>
                            {% else %}
                            <p class="positivo">{{ recolher|floatformat:2 }}</p>
                            {% endif %}
                        </td>
                    </tr>
                    {% endif %}
{% endfor %}

                </tbody>
            </table>
        </div>
    </div>
</div>
<!---------------------------------------------------------------------------------------------->
<script>
$(document).ready( function () {
    $('#tabelaRecolher').DataTable({
        "language": {
            "url":"https://cdn.datatables.net/plug-ins/1.10.24/i18n/Portuguese-Brasil.json",
        },
        "dom": '',
        paging: false  
    });
    $('#tabelaRecolherinativo').DataTable({
        "language": {
            "url":"https://cdn.datatables.net/plug-ins/1.10.24/i18n/Portuguese-Brasil.json",
        },
        "dom": '',
        paging: false  
    });
} );
</script>

{% endblock %}